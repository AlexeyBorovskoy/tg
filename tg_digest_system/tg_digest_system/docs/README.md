# TG Digest System ‚Äî –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ß—Ç–æ —ç—Ç–æ –∑–∞ —Å–∏—Å—Ç–µ–º–∞](#1-—á—Ç–æ-—ç—Ç–æ-–∑–∞-—Å–∏—Å—Ç–µ–º–∞)
2. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#2-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#3-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–ü–æ–¥—Ä–æ–±–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#4-–ø–æ–¥—Ä–æ–±–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram](#5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-telegram)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–æ–≤](#6-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–∞–Ω–∞–ª–æ–≤)
7. [–ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤](#7-–Ω–∞–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–º–ø—Ç–æ–≤)
8. [–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã](#8-–∑–∞–ø—É—Å–∫-—Å–∏—Å—Ç–µ–º—ã)
9. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏](#9-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏)
10. [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#10-—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)
11. [FAQ](#11-faq)

---

## 1. –ß—Ç–æ —ç—Ç–æ –∑–∞ —Å–∏—Å—Ç–µ–º–∞

**TG Digest System** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Telegram-–∫–∞–Ω–∞–ª–æ–≤ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏—Ö –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram       ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  PostgreSQL     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  OpenAI GPT     ‚îÇ
‚îÇ  –∫–∞–Ω–∞–ª—ã         ‚îÇ     ‚îÇ  (—Ö—Ä–∞–Ω–µ–Ω–∏–µ)     ‚îÇ     ‚îÇ  (–∞–Ω–∞–ª–∏–∑)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                               ‚îÇ
        ‚îÇ                                               ‚ñº
        ‚îÇ                                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                                       ‚îÇ  –î–∞–π–¥–∂–µ—Å—Ç       ‚îÇ
        ‚îÇ                                       ‚îÇ  (Markdown)     ‚îÇ
        ‚îÇ                                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                               ‚îÇ
        ‚ñº                                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                             ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  OCR            ‚îÇ                             ‚îÇ  –†–∞—Å—Å—ã–ª–∫–∞       ‚îÇ
‚îÇ  (Tesseract)    ‚îÇ                             ‚îÇ  –≤ Telegram     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

1. **–°–±–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π** ‚Äî —á–∏—Ç–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö Telegram-–∫–∞–Ω–∞–ª–æ–≤
2. **OCR** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö (—Å–∫—Ä–∏–Ω—à–æ—Ç—ã, —Ñ–æ—Ç–æ)
3. **–ê–Ω–∞–ª–∏–∑** ‚Äî ChatGPT —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–∏–π –¥–∞–π–¥–∂–µ—Å—Ç –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–º–ø—Ç—É
4. **–†–∞—Å—Å—ã–ª–∫–∞** ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º –≤ Telegram

### –î–ª—è –∫–æ–≥–æ:

- –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ –∫–æ–º–∞–Ω–¥ –ê–°–£–î–î
- –ò–Ω–∂–µ–Ω–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤
- –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–µ—Ä–≤–µ—Ä

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ú–∏–Ω–∏–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
|----------|---------|---------------|
| CPU | 1 —è–¥—Ä–æ | 2 —è–¥—Ä–∞ |
| RAM | 1 GB | 2 GB |
| –î–∏—Å–∫ | 10 GB | 20 GB |
| –û–° | Ubuntu 22.04+ | Ubuntu 24.04 |

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ

- **Docker** 24.0+ –∏ **Docker Compose** 2.20+
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (Telegram API, OpenAI API)

### –ê–∫–∫–∞—É–Ω—Ç—ã –∏ –∫–ª—é—á–∏

| –ß—Ç–æ –Ω—É–∂–Ω–æ | –ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å | –î–ª—è —á–µ–≥–æ |
|-----------|--------------|----------|
| Telegram API ID –∏ Hash | https://my.telegram.org | –ß—Ç–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ |
| Telegram Bot Token | https://t.me/BotFather | –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ |
| OpenAI API Key | https://platform.openai.com | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ |

---

## 3. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ï—Å–ª–∏ –≤—ã –æ–ø—ã—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –≤–æ—Ç –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
git clone <repository> tg_digest_system
cd tg_digest_system

# 2. –ö–æ–ø–∏—Ä—É–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º .env
cp .env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–∞–Ω–∞–ª—ã
nano config/channels.json

# 4. –ê–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è –≤ Telegram (–æ–¥–∏–Ω —Ä–∞–∑)
cd docker
docker-compose run --rm auth

# 5. –ó–∞–ø—É—Å–∫–∞–µ–º
docker-compose up -d

# 6. –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker-compose logs -f worker
```

---

## 4. –ü–æ–¥—Ä–æ–±–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 4.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker (Ubuntu)

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
sudo apt install -y ca-certificates curl gnupg

# –î–æ–±–∞–≤–ª—è–µ–º GPG –∫–ª—é—á Docker
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker (—á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å sudo)
sudo usermod -aG docker $USER

# –í–ê–ñ–ù–û: –ü–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
newgrp docker

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É
docker --version
docker compose version
```

### 4.2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞—ë–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
mkdir -p ~/projects
cd ~/projects

# –ï—Å–ª–∏ –µ—Å—Ç—å git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
git clone <repository_url> tg_digest_system

# –ò–ª–∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤:
unzip tg_digest_system.zip
cd tg_digest_system
```

### 4.3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tg_digest_system/
‚îú‚îÄ‚îÄ .env.example          # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt      # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ channels.json     # ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤ (–†–ï–î–ê–ö–¢–ò–†–£–ï–ú)
‚îÇ   ‚îî‚îÄ‚îÄ channels.schema.json
‚îÇ
‚îú‚îÄ‚îÄ prompts/              # üìù –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è LLM (–†–ï–î–ê–ö–¢–ò–†–£–ï–ú)
‚îÇ   ‚îú‚îÄ‚îÄ asudd_main.md
‚îÇ   ‚îú‚îÄ‚îÄ controllers.md
‚îÇ   ‚îú‚îÄ‚îÄ detectors.md
‚îÇ   ‚îî‚îÄ‚îÄ api_integrations.md
‚îÇ
‚îú‚îÄ‚îÄ scripts/              # Python –∫–æ–¥ (–Ω–µ —Ç—Ä–æ–≥–∞–µ–º)
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ database.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_client.py
‚îÇ   ‚îú‚îÄ‚îÄ ocr.py
‚îÇ   ‚îú‚îÄ‚îÄ llm.py
‚îÇ   ‚îî‚îÄ‚îÄ digest_worker.py
‚îÇ
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ schema.sql        # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ init_db.sh
‚îÇ
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml
‚îÇ
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ README.md         # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram

### 5.1. –ü–æ–ª—É—á–µ–Ω–∏–µ API ID –∏ API Hash

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://my.telegram.org
2. –í–æ–π–¥–∏—Ç–µ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "API development tools"
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   - App title: `TG Digest System`
   - Short name: `tgdigest`
   - Platform: `Other`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **App api_id** –∏ **App api_hash**

> ‚ö†Ô∏è **–í–ê–ñ–ù–û**: –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É. –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∏—Ö —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º!

### 5.2. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://t.me/BotFather
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞: `ASUDD Digest Bot`
4. –í–≤–µ–¥–∏—Ç–µ username: `asudd_digest_bot` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º)
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **—Ç–æ–∫–µ–Ω** (—Ñ–æ—Ä–º–∞—Ç: `1234567890:ABCdefGHI...`)

> üí° **–°–æ–≤–µ—Ç**: –¢–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ `/setdescription`

### 5.3. –ü–æ–ª—É—á–µ–Ω–∏–µ ID –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

–ß—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–π–¥–∂–µ—Å—Ç—ã, –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://t.me/userinfobot
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à ID

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ @RawDataBot**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://t.me/RawDataBot
2. –ü–µ—Ä–µ—à–ª–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏—Ç–µ `"id":`

### 5.4. –ü–æ–ª—É—á–µ–Ω–∏–µ ID –∫–∞–Ω–∞–ª–æ–≤

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–≤–µ—Ä—Å–∏—é**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://web.telegram.org
2. –ó–∞–π–¥–∏—Ç–µ –≤ –Ω—É–∂–Ω—ã–π –∫–∞–Ω–∞–ª
3. –í URL –±—É–¥–µ—Ç `#-1001234567890` ‚Äî —ç—Ç–æ ID (—Å–æ –∑–Ω–∞–∫–æ–º –º–∏–Ω—É—Å)

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ—Å—ã–ª–∫—É –≤ @RawDataBot**

> ‚ö†Ô∏è **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –∫–∞–Ω–∞–ª–∞!

---

## 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–æ–≤

### 6.1. –§–∞–π–ª .env

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cp .env.example .env
nano .env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.env`:

```bash
# Telegram API (—Å my.telegram.org)
TG_API_ID=12345678
TG_API_HASH=abcdef1234567890abcdef

# Telegram Bot (–æ—Ç BotFather)
TG_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# PostgreSQL (–ø—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å)
PGDATABASE=tg_digest
PGUSER=tg_digest
PGPASSWORD=MyStr0ngP@ssw0rd!

# OpenAI (—Å platform.openai.com)
OPENAI_API_KEY=sk-proj-abcdefghijklmnop
OPENAI_MODEL=gpt-4o

# –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
TZ=Europe/Moscow
```

### 6.2. –§–∞–π–ª channels.json

–û—Ç–∫—Ä–æ–π—Ç–µ `config/channels.json` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

```json
{
  "channels": [
    {
      "id": -1002700886173,
      "name": "–ê–°–£–î–î –û—Å–Ω–æ–≤–Ω–æ–π",
      "description": "–ì–ª–∞–≤–Ω—ã–π –∫–∞–Ω–∞–ª –∫–æ–º–∞–Ω–¥—ã",
      "enabled": true,
      "peer_type": "channel",
      "prompt_file": "prompts/asudd_main.md",
      "poll_interval_minutes": 30,
      "recipients": [
        {
          "telegram_id": 123456789,
          "name": "–ò–≤–∞–Ω–æ–≤ –ò.–ò.",
          "role": "lead",
          "send_file": true,
          "send_text": true
        },
        {
          "telegram_id": 987654321,
          "name": "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.",
          "role": "manager",
          "send_file": true,
          "send_text": false
        }
      ]
    }
  ],
  
  "defaults": {
    "poll_interval_minutes": 30,
    "llm_provider": "openai",
    "llm_model": "gpt-4o",
    "ocr_enabled": true,
    "media_save_to_db": true
  }
}
```

### –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –ø–æ–ª—è–º:

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `id` | ID –∫–∞–Ω–∞–ª–∞ –≤ Telegram (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ) |
| `name` | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ |
| `enabled` | `true` ‚Äî –∫–∞–Ω–∞–ª –∞–∫—Ç–∏–≤–µ–Ω, `false` ‚Äî –æ—Ç–∫–ª—é—á—ë–Ω |
| `prompt_file` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø—Ä–æ–º–ø—Ç–∞ |
| `recipients` | –°–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–∞–π–¥–∂–µ—Å—Ç–∞ |
| `send_file` | –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏ .md —Ñ–∞–π–ª |
| `send_text` | –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º |

---

## 7. –ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

–ü—Ä–æ–º–ø—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `prompts/`. –ö–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–π –ø—Ä–æ–º–ø—Ç.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞

```markdown
# –ü—Ä–æ–º–ø—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ

## –†–æ–ª—å
–ö—Ç–æ —Ç—ã –∏ —á—Ç–æ –¥–µ–ª–∞–µ—à—å

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
–¢–µ—Ä–º–∏–Ω—ã, —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è, —Ç–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

## –§–æ—Ä–º–∞—Ç –¥–∞–π–¥–∂–µ—Å—Ç–∞
–ö–∞–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –ü—Ä–∞–≤–∏–ª–∞
–ß—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å

## –ü—Ä–∏–º–µ—Ä—ã
–•–æ—Ä–æ—à–∏–µ –∏ –ø–ª–æ—Ö–∏–µ –ø—Ä–∏–º–µ—Ä—ã
```

### –°–æ–≤–µ—Ç—ã –ø–æ –ø—Ä–æ–º–ø—Ç–∞–º:

1. **–ë—É–¥—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã** ‚Äî —á–µ–º —Ç–æ—á–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, —Ç–µ–º –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
2. **–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∏–º–µ—Ä—ã** ‚Äî LLM —É—á–∏—Ç—Å—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö
3. **–£–∫–∞–∂–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —á—ë—Ç–∫–æ–π
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ msg_id** ‚Äî —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏

---

## 8. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### 8.1. –ü–µ—Ä–≤–∏—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Telegram

**–≠—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑!**

```bash
cd docker
docker-compose run --rm auth
```

–í–≤–µ–¥–∏—Ç–µ:
1. –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Å –∫–æ–¥–æ–º —Å—Ç—Ä–∞–Ω—ã: +7...)
2. –ö–æ–¥ –∏–∑ Telegram
3. –ü–∞—Ä–æ–ª—å 2FA (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫: –í–∞—à–µ –ò–º—è (ID: 123456789)
```

### 8.2. –ó–∞–ø—É—Å–∫ –≤ Docker

```bash
cd docker

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f worker
```

### 8.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart worker

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)
docker-compose up -d --build worker

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ PostgreSQL
docker-compose logs postgres
```

### 8.4. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –∫–∞–Ω–∞–ª—ã –æ–¥–∏–Ω —Ä–∞–∑
docker-compose exec worker python /app/scripts/digest_worker.py --once

# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–∞–Ω–∞–ª
docker-compose exec worker python /app/scripts/digest_worker.py --channel -1002700886173 --once
```

---

## 9. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –õ–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker-compose logs --tail 100 worker

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f worker

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª
docker-compose logs worker > worker.log
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ß–µ—Ä–µ–∑ docker
docker-compose exec postgres psql -U tg_digest -d tg_digest

# –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

-- –°–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ–±—Ä–∞–Ω–æ
SELECT peer_id, COUNT(*) as cnt FROM tg.messages GROUP BY peer_id;

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã
SELECT id, peer_id, msg_id_from, msg_id_to, created_at 
FROM rpt.digests ORDER BY created_at DESC LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
SELECT status, COUNT(*) FROM rpt.deliveries GROUP BY status;

-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–æ–≤
SELECT * FROM rpt.report_state;
```

---

## 10. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "TG_API_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω —Ñ–∞–π–ª `.env`

**–†–µ—à–µ–Ω–∏–µ**:
```bash
cp .env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

### –ü—Ä–æ–±–ª–µ–º–∞: "FloodWaitError"

**–ü—Ä–∏—á–∏–Ω–∞**: Telegram –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∏–∑-–∑–∞ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–¥–æ–∂–¥–∏—Ç–µ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–æ–±—ã—á–Ω–æ 5-30 –º–∏–Ω—É—Ç)

### –ü—Ä–æ–±–ª–µ–º–∞: "Could not find the input entity"

**–ü—Ä–∏—á–∏–Ω–∞**: –ê–∫–∫–∞—É–Ω—Ç –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –∫–∞–Ω–∞–ª–µ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π ID

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫ –∫–∞–Ω–∞–ª–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID –∫–∞–Ω–∞–ª–∞ (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `-100`)

### –ü—Ä–æ–±–ª–µ–º–∞: "OpenAI API error: insufficient_quota"

**–ü—Ä–∏—á–∏–Ω–∞**: –ó–∞–∫–æ–Ω—á–∏–ª—Å—è –±–∞–ª–∞–Ω—Å OpenAI

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://platform.openai.com/account/billing

### –ü—Ä–æ–±–ª–µ–º–∞: OCR –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
docker-compose exec worker tesseract --version
```

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
```bash
docker-compose build --no-cache worker
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞—á–∞–ª –¥–∏–∞–ª–æ–≥ —Å –±–æ—Ç–æ–º

**–†–µ—à–µ–Ω–∏–µ**: –ö–∞–∂–¥—ã–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –Ω–∞–ø–∏—Å–∞—Ç—å `/start` –±–æ—Ç—É

---

## 11. FAQ

### Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª?

1. –û—Ç–∫—Ä–æ–π—Ç–µ `config/channels.json`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ `channels`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `docker-compose restart worker`

### Q: –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–ø—Ä–æ—Å–∞?

–í `docker-compose.yml` –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```yaml
command: ["--interval", "15"]  # 15 –º–∏–Ω—É—Ç
```

### Q: –ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å OCR?

–í `config/channels.json`:
```json
"defaults": {
  "ocr_enabled": false
}
```

### Q: –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã?

```sql
SELECT digest_llm FROM rpt.digests ORDER BY created_at DESC LIMIT 1;
```

### Q: –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞?

- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` (–Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ git!)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ

### Q: –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç OpenAI?

GPT-4o: ~$5 –∑–∞ 1M –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤, ~$15 –∑–∞ 1M –≤—ã—Ö–æ–¥–Ω—ã—Ö.
–û–¥–∏–Ω –¥–∞–π–¥–∂–µ—Å—Ç ‚âà 2000-5000 —Ç–æ–∫–µ–Ω–æ–≤ ‚âà $0.01-0.05

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã.
